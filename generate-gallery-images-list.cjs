const fs = require('fs');
const path = require('path');

const galleryRoot = path.join(__dirname, 'public/images/gallery');
const outputFile = path.join(__dirname, 'src/data/gallery-images.ts');
const exts = ['.png', '.jpg', '.jpeg', '.webp'];

const folders = fs
  .readdirSync(galleryRoot)
  .filter((f) => fs.statSync(path.join(galleryRoot, f)).isDirectory());

const galleries = {};

folders.forEach((folder) => {
  const folderPath = path.join(galleryRoot, folder);
  const files = fs
    .readdirSync(folderPath)
    .filter((file) => exts.includes(path.extname(file).toLowerCase()))
    .sort();
  galleries[folder] = files.map((f) => `/images/gallery/${folder}/${f}`);
});

const content = `// Auto-generated by generate-gallery-images-list.cjs
export const galleryImages: Record<string, string[]> = ${JSON.stringify(galleries, null, 2)};
`;

fs.mkdirSync(path.dirname(outputFile), { recursive: true });
fs.writeFileSync(outputFile, content);

console.log(`✅ gallery-images.ts généré avec les dossiers : ${Object.keys(galleries).join(', ')}`);
